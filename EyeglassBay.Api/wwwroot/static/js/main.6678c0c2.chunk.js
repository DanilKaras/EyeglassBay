(this["webpackJsonpclient-app"]=this["webpackJsonpclient-app"]||[]).push([[0],{235:function(e,t,n){},361:function(e,t,n){"use strict";n.r(t),n.d(t,"history",(function(){return ye}));var r=n(0),c=n(43),a=n.n(c),s=(n(234),n(235),n(372)),o=n(376),i=n(219),l=n(375),u=n(35),j=n(15),d=n.n(j),b=n(32),h=n(10),O=n(11),p=n(26),x=n.n(p),f=n(111);x.a.defaults.baseURL="/api",x.a.interceptors.request.use((function(e){var t=L.commonStore.token;return t&&(e.headers.Authorization="Bearer ".concat(t)),e})),x.a.interceptors.response.use(function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){var t=e.response,n=t.data,r=t.status,c=t.config;switch(r){case 400:if("string"===typeof n&&f.b.error(n),"get"===c.method&&n.errors.hasOwnProperty("id")&&ye.push("/not-found"),n.errors){var a=[];for(var s in n.errors)n.errors[s]&&a.push(n.errors[s]);throw a.flat()}f.b.error(n);break;case 401:break;case 404:ye.push("/not-found");break;case 500:L.commonStore.setServerError(e),ye.push("/server-error")}return Promise.reject(e)}));var m=function(e){return e.data},g=function(e){return x.a.get(e).then(m)},v=function(e,t){return x.a.get(e,t).then(m)},y=function(e,t){return x.a.post(e,t).then(m)},w=function(e,t){return x.a.put(e,t).then(m)},S=function(e){return x.a.delete(e).then(m)},I={EyeGlasses:{listAll:function(){return g("/EyeGlasses")},getById:function(e){return g("/EyeGlasses/".concat(e))},create:function(e){return y("/EyeGlasses",e)},update:function(e){return w("/EyeGlasses/".concat(e.id),e)},delete:function(e){return S("/EyeGlasses/".concat(e))}},Account:{current:function(){return g("/account")},login:function(e){return y("/account/login",e)}},EbayParser:{getItems:function(e){return v("/EbaySearch",{params:{searchString:e.searchString,originalPrice:e.originalPrice,coefficient:e.coefficient}})},getMinItem:function(e){return v("/EbaySearch/min",{params:{searchString:e.searchString,originalPrice:e.originalPrice,coefficient:e.coefficient}})}}},k=n(12),E=function(){function e(){var t=this;Object(h.a)(this,e),this.user=null,this.login=function(){var e=Object(b.a)(d.a.mark((function e(n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.Account.login(n);case 3:r=e.sent,L.commonStore.setToken(r.token),Object(O.h)((function(){t.user=r})),ye.push("/search"),L.modalStore.closeModal(),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),this.logout=function(){L.commonStore.setToken(null),window.localStorage.removeItem("jwt"),t.user=null,ye.push("/")},this.getUser=Object(b.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.Account.current();case 3:n=e.sent,Object(O.h)((function(){return t.user=n})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),Object(O.d)(this)}return Object(k.a)(e,[{key:"isLoggedIn",get:function(){return!!this.user}}]),e}(),L={eyeglassStore:new function e(){var t=this;Object(h.a)(this,e),this.eyeGlasses=[],this.loading=!1,this.loadingInitial=!1,this.loadEyeglasses=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setLoadingInitial(!0),e.prev=1,e.next=4,I.EyeGlasses.listAll();case 4:t.eyeGlasses=e.sent,t.setLoadingInitial(!1),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),t.setLoadingInitial(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])}))),this.setLoadingInitial=function(e){t.loadingInitial=e},Object(O.d)(this)},commonStore:new function e(){var t=this;Object(h.a)(this,e),this.error=null,this.token=window.localStorage.getItem("jwt"),this.appLoaded=!1,this.setServerError=function(e){t.error=e},this.setToken=function(e){t.token=e},this.setAppLoaded=function(){t.appLoaded=!0},Object(O.d)(this),Object(O.g)((function(){return t.token}),(function(e){e?window.localStorage.setItem("jwt",e):window.localStorage.removeItem("jwt")}))},userStore:new E,modalStore:new function e(){var t=this;Object(h.a)(this,e),this.modal={open:!1,body:null},this.openModal=function(e){t.modal.open=!0,t.modal.body=e},this.closeModal=function(){t.modal.open=!1,t.modal.body=null},Object(O.d)(this)},ebayParserStore:new function e(){var t=this;Object(h.a)(this,e),this.minItem={},this.ebayItems=[],this.loading=!1,this.getMinItemByRequest=function(){var e=Object(b.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.toggleLoad(!0),e.next=4,I.EbayParser.getMinItem(n);case 4:t.minItem=e.sent,t.toggleLoad(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t.toggleLoad(!0,e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),this.getAllItemByRequest=function(){var e=Object(b.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.toggleLoad(!0),e.next=4,I.EbayParser.getItems(n);case 4:t.ebayItems=e.sent,t.toggleLoad(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t.toggleLoad(!0,e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),this.toggleLoad=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t.loading=e,n&&console.log(n)},Object(O.d)(this)}},P=Object(r.createContext)(L);function C(){return Object(r.useContext)(P)}var G=n(22),F=n(2),q=Object(G.a)((function(){var e=C().userStore.logout;return Object(F.jsx)(o.a,{inverted:!0,fixed:"top",children:Object(F.jsxs)(s.a,{children:[Object(F.jsx)(o.a.Item,{as:u.b,to:"/",exact:!0,header:!0,children:Object(F.jsx)("img",{src:"/eye-glasses.png",alt:"logo"})}),Object(F.jsx)(o.a.Item,{as:u.b,to:"/search",name:"Search"}),Object(F.jsx)(o.a.Item,{as:u.b,to:"/eyeglasses",name:"Eye Glasses"}),Object(F.jsx)(o.a.Item,{as:u.b,to:"/document-upload",name:"Upload Doc"}),Object(F.jsxs)(o.a.Item,{position:"right",children:[Object(F.jsx)(i.a,{src:"/user.png",avatar:!0,spaced:"right"}),Object(F.jsx)(l.a,{pointing:"top left",text:"Admin",children:Object(F.jsx)(l.a.Menu,{children:Object(F.jsx)(l.a.Item,{onClick:e,text:"Logout",icon:"power"})})})]})]})})})),A=n(16),B=n(387),T=n(386),D=n(383),M=n(80),N=n(377),z=n(153),R=n(82),U=n(45),V=function(e){var t=Object(M.c)(e.name),n=Object(U.a)(t,2),r=n[0],c=n[1];return Object(F.jsxs)(N.a.Field,{fluid:!0,width:e.width,error:c.touched&&!!c.error,children:[Object(F.jsx)("label",{children:e.label}),Object(F.jsx)("input",Object(R.a)(Object(R.a)({},r),e)),c.touched&&c.error?Object(F.jsx)(z.a,{basic:!0,color:"red",children:c.error}):null]})},$=Object(G.a)((function(){var e=C().userStore;return Object(F.jsx)(M.b,{initialValues:{email:"",password:"",error:null},onSubmit:function(t,n){var r=n.setErrors;return e.login(t).catch((function(){return r({error:"Invalid email or password"})}))},children:function(e){var t=e.handleSubmit,n=e.isSubmitting,r=e.errors;return Object(F.jsxs)(N.a,{className:"ui form",onSubmit:t,autoComplete:"off",children:[Object(F.jsx)(T.a,{as:"h2",content:"Login to Eyeglass Bay",color:"teal",textAlign:"center"}),Object(F.jsx)(V,{name:"email",placeholder:"Email"}),Object(F.jsx)(V,{name:"password",placeholder:"Password",type:"password"}),Object(F.jsx)(M.a,{name:"error",render:function(){return Object(F.jsx)(z.a,{style:{marginBottom:10},basic:!0,color:"red",content:r.error})}}),Object(F.jsx)(D.a,{loading:n,positive:!0,content:"Login",type:"submit",fluid:!0})]})}})})),J=function(){var e=C(),t=e.userStore,n=e.modalStore;return Object(F.jsx)(B.a,{inverted:!0,textAlign:"center",vertical:!0,className:"masthead",children:Object(F.jsxs)(s.a,{text:!0,children:[Object(F.jsxs)(T.a,{as:"h1",inverted:!0,children:[Object(F.jsx)(i.a,{size:"massive",src:"/eye-glasses.png",alt:"logo",style:{marginBottom:"0.2em"}}),"Eyeglass Bay"]}),t.isLoggedIn?Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(D.a,{as:u.a,to:"/search",size:"huge",inverted:!0,children:"Go to Search!"})}):Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(D.a,{onClick:function(){return n.openModal(Object(F.jsx)($,{}))},size:"huge",inverted:!0,children:"Login!"})})]})})},H=n(218),Y=["component"];function _(e){var t=e.component,n=Object(H.a)(e,Y),r=C().userStore.isLoggedIn;return Object(F.jsx)(A.b,Object(R.a)(Object(R.a)({},n),{},{render:function(e){return r?Object(F.jsx)(t,Object(R.a)({},e)):Object(F.jsx)(A.a,{to:"/"})}}))}var K=n(384),Q=n(373),W=function(e){var t=e.inverted,n=void 0===t||t,r=e.content,c=void 0===r?"Loading...":r;return Object(F.jsx)(K.a,{active:!0,inverted:n,children:Object(F.jsx)(Q.a,{content:c})})},X=n(379),Z=Object(G.a)((function(){var e=C().modalStore;return Object(F.jsx)(X.a,{open:e.modal.open,onClose:e.closeModal,size:"mini",children:Object(F.jsx)(X.a.Content,{children:e.modal.body})})})),ee=n(380),te=Object(G.a)((function(){var e=C().eyeglassStore;return Object(r.useEffect)((function(){(function(){var t=Object(b.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadEyeglasses();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),e.loadingInitial?Object(F.jsx)(W,{content:"Loading app"}):Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(ee.a,{children:e.eyeGlasses.map((function(e){return Object(F.jsx)(ee.a.Item,{children:e.productName},e.id)}))})})})),ne=Object(G.a)((function(){return Object(F.jsx)("h1",{children:"Document Upload goes here"})})),re=n(381),ce=function(e){var t=e.errors;return Object(F.jsx)(re.a,{error:!0,children:t&&Object(F.jsx)(re.a.List,{children:t.map((function(e,t){return Object(F.jsx)(re.a.Item,{children:e},t)}))})})},ae=function(){var e=Object(r.useState)(null),t=Object(U.a)(e,2),n=t[0],c=t[1];return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(T.a,{as:"h1",content:"Test Error component"}),Object(F.jsx)(B.a,{children:Object(F.jsxs)(D.a.Group,{widths:"7",children:[Object(F.jsx)(D.a,{onClick:function(){x.a.get("/buggy/not-found").catch((function(e){return console.log(e.response)}))},content:"Not Found",basic:!0,primary:!0}),Object(F.jsx)(D.a,{onClick:function(){x.a.get("/buggy/bad-request").catch((function(e){return console.log(e.response)}))},content:"Bad Request",basic:!0,primary:!0}),Object(F.jsx)(D.a,{onClick:function(){x.a.post("eyeGlasses",{}).catch((function(e){c(e)}))},content:"Validation Error",basic:!0,primary:!0}),Object(F.jsx)(D.a,{onClick:function(){x.a.get("/buggy/server-error").catch((function(e){return console.log(e.response)}))},content:"Server Error",basic:!0,primary:!0}),Object(F.jsx)(D.a,{onClick:function(){x.a.get("/buggy/unauthorised").catch((function(e){return console.log(e.response)}))},content:"Unauthorised",basic:!0,primary:!0}),Object(F.jsx)(D.a,{onClick:function(){x.a.get("EyeGlasses/dab").catch((function(e){return console.log(e.response)}))},content:"Bad Guid",basic:!0,primary:!0})]})}),n&&Object(F.jsx)(ce,{errors:n})]})},se=Object(G.a)((function(){var e,t,n=C().commonStore;return Object(F.jsxs)(s.a,{children:[Object(F.jsx)(T.a,{as:"h1",content:"Server Error"}),Object(F.jsx)(T.a,{sub:!0,as:"h5",color:"red",content:null===(e=n.error)||void 0===e?void 0:e.response.statusText}),(null===(t=n.error)||void 0===t?void 0:t.response.data)&&Object(F.jsxs)(B.a,{children:[Object(F.jsx)(T.a,{as:"h4",content:"Stack trace",color:"teal"}),Object(F.jsx)("code",{style:{marginTop:"10px"},children:n.error.response.data})]})]})})),oe=n(73),ie=function(){return Object(F.jsxs)(B.a,{children:[Object(F.jsxs)(T.a,{icon:!0,children:[Object(F.jsx)(oe.a,{name:"search"}),"Oops - we've looked everywhere and could not find this."]}),Object(F.jsx)(B.a.Inline,{children:Object(F.jsx)(D.a,{as:u.a,to:"/search",primary:!0,children:"Return to Main page"})})]})},le=n(388),ue=n(374),je=n(378),de=n(382),be=function(){return Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(B.a,{children:Object(F.jsx)(je.a.Group,{divided:!0,children:Object(F.jsxs)(je.a,{children:[Object(F.jsx)(je.a.Image,{size:"small",children:Object(F.jsx)(de.a,{children:Object(F.jsx)(de.a.Image,{rectangular:!0})})}),Object(F.jsx)(je.a.Content,{children:Object(F.jsxs)(de.a,{fluid:!0,children:[Object(F.jsx)(de.a.Line,{}),Object(F.jsx)(de.a.Line,{}),Object(F.jsx)(de.a.Line,{})]})})]})})})})},he=n(120),Oe=Object(G.a)((function(){var e=C().ebayParserStore,t=e.getAllItemByRequest,n=Object(r.useState)({searchString:""}),c=Object(U.a)(n,1)[0],a=he.b({searchString:he.c().required("The search string is required"),originalPrice:he.a().typeError("Number is required").required("Price is required").moreThan(0,"Price must be greater than 0"),coefficient:he.a().typeError("Number is required").required("Coefficient is required").moreThan(0,"Coefficient must be greater than 0")}),s=function(){var e=Object(b.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(M.b,{validationSchema:a,enableReinitialize:!0,initialValues:c,onSubmit:function(e){return s(e)},children:function(t){var n=t.handleSubmit,r=t.isValid,c=t.isSubmitting,a=(t.errors,t.dirty);return Object(F.jsxs)(N.a,{onSubmit:n,autoComplete:"off",children:[Object(F.jsxs)(N.a.Group,{widths:"equal",children:[Object(F.jsx)(V,{name:"searchString",placeholder:"Search",type:"text",width:10}),Object(F.jsx)(V,{name:"originalPrice",placeholder:"Price",type:"text",width:4}),Object(F.jsx)(V,{name:"coefficient",placeholder:"Coefficient",type:"text",width:4})]}),Object(F.jsx)(D.a,{disabled:e.loading||c||!a||!r,loading:e.loading,positive:!0,type:"submit",floated:"right",content:"Submit"})]})}})})})),pe=function(e){var t=e.item;return Object(F.jsxs)(je.a,{children:[Object(F.jsx)(je.a.Image,{size:"small",label:t.isMyShop&&{color:"green",corner:"left",icon:"check",tooltip:"Your shop"},src:t.image}),Object(F.jsxs)(je.a.Content,{children:[Object(F.jsx)(je.a.Header,{children:t.productName}),Object(F.jsx)(je.a.Meta,{children:Object(F.jsxs)(z.a,{color:"teal",children:[Object(F.jsx)(oe.a,{name:"money"})," ",t.price," $",Object(F.jsx)(z.a.Detail,{children:t.isDiscounted?"Discount is ".concat(t.discount," %"):"No Discount"})]})}),Object(F.jsxs)(je.a.Description,{children:[Object(F.jsxs)("span",{children:["Seller: ",Object(F.jsx)("b",{children:t.shopName})]}),t.isDiscounted&&Object(F.jsxs)("span",{children:[" | Price with no discount: ",Object(F.jsxs)("b",{children:[t.priceNoDiscount," $"]})," "]}),(!t.isFreeDelivery||t.isDeliveryNotSpecified)&&Object(F.jsxs)("span",{children:[" | Delivery: ",Object(F.jsxs)("b",{children:[t.deliveryPrice||"No specified"," $"]})," "]}),Object(F.jsxs)("span",{children:[" | Total Price ",Object(F.jsxs)("b",{children:[t.totalPrice," $"]})]})]}),Object(F.jsxs)(je.a.Extra,{children:[Object(F.jsxs)(z.a,{as:"a",color:"blue",href:t.url,target:"_blank",children:[Object(F.jsx)(oe.a,{name:"globe"})," Visit Page"]}),Object(F.jsxs)(z.a,{color:t.profit>0?"green":"red",children:[Object(F.jsx)(oe.a,{name:"money"})," Profit $ ",t.profit]})]})]})]})},xe=Object(G.a)((function(){var e=C().ebayParserStore;return Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)(le.a,{centered:!0,children:[Object(F.jsx)(le.a.Row,{children:Object(F.jsx)(le.a.Column,{width:16,children:Object(F.jsx)(Oe,{})})}),Object(F.jsx)(ue.a,{horizontal:!0,children:Object(F.jsxs)(T.a,{as:"h4",children:[Object(F.jsx)(oe.a,{name:"tag"}),"Eyeglasses"]})}),Object(F.jsx)(le.a.Row,{children:Object(F.jsxs)(le.a.Column,{width:16,children:[e.loading&&Object(F.jsx)(be,{}),!e.loading&&e.ebayItems&&e.ebayItems.length>0&&Object(F.jsx)(B.a,{children:Object(F.jsx)(je.a.Group,{divided:!0,children:e.ebayItems.map((function(e){return Object(F.jsx)(pe,{item:e})}))})})]})})]})})}));var fe=Object(G.a)((function(){var e=C(),t=e.commonStore,n=e.userStore;return Object(r.useEffect)((function(){t.token?n.getUser().finally((function(){return t.setAppLoaded()})):t.setAppLoaded()}),[t,n]),t.appLoaded?Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(f.a,{position:"bottom-right",hideProgressBar:!0}),Object(F.jsx)(Z,{}),Object(F.jsx)(A.b,{exact:!0,path:"/",component:J}),Object(F.jsx)(A.b,{path:"/(.+)",render:function(){return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)(q,{}),Object(F.jsx)(s.a,{style:{marginTop:"7em"},children:Object(F.jsxs)(A.d,{children:[Object(F.jsx)(_,{exact:!0,path:"/",component:J}),Object(F.jsx)(_,{path:"/search",component:xe}),Object(F.jsx)(_,{path:"/eyeglasses",component:te}),Object(F.jsx)(_,{path:"/document-upload",component:ne}),Object(F.jsx)(_,{path:"/errors",component:ae}),Object(F.jsx)(A.b,{path:"/server-error",component:se}),Object(F.jsx)(A.b,{component:ie})]})})]})}})]}):Object(F.jsx)(W,{content:"Loading app..."})})),me=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,390)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))},ge=(n(360),n(33));function ve(){var e=Object(A.g)().pathname;return Object(r.useEffect)((function(){window.scrollTo(0,0)}),[e]),null}var ye=Object(ge.a)();a.a.render(Object(F.jsx)(P.Provider,{value:L,children:Object(F.jsxs)(A.c,{history:ye,children:[Object(F.jsx)(ve,{}),Object(F.jsx)(fe,{})]})}),document.getElementById("root")),me()}},[[361,1,2]]]);
//# sourceMappingURL=main.6678c0c2.chunk.js.map